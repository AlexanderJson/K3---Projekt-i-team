/* ==========================================================================
   CONTACTS.CSS — Master-Detail Layout for Contact Module
   Uses existing CSS variables from variables.css
   ========================================================================== */

/* ===== SHELL: Master-Detail Container ===== */
.contacts-shell {
  display: flex;
  flex-direction: column;
  height: calc(100vh - 120px);
  gap: 0;
  overflow: hidden;
}

@media (min-width: 768px) {
  .contacts-shell {
    flex-direction: row;
    height: calc(100vh - 60px);
  }
}

/* ===== MASTER PANEL (Left: List) ===== */
.contacts-master {
  display: flex;
  flex-direction: column;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
  min-height: 0;
}

@media (min-width: 768px) {
  .contacts-master {
    width: 280px; /* Smaller width for tablet */
    min-width: 260px;
    flex-shrink: 0;
    border-radius: 12px 0 0 12px;
    border-right: none;
  }
}

@media (min-width: 1024px) {
  .contacts-master {
    width: 360px; /* Full width for desktop */
    min-width: 320px;
  }
}

@media (max-width: 767px) {
  .contacts-master {
    flex: 1;
  }
  .contacts-master.hidden-mobile {
    display: none;
  }
}

/* ===== MASTER HEADER ===== */
.contacts-master-header {
  padding: 16px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}

.contacts-master-header h2 {
  margin: 0 0 12px 0;
  font-size: 16px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--text-main);
}

.contacts-search {
  width: 100%;
  padding: 10px 14px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--bg-element);
  color: var(--text-main);
  font-size: 14px;
  font-family: inherit;
  outline: none;
  transition: border-color 0.2s;
}

.contacts-search:focus {
  border-color: var(--accent-cyan);
}

.contacts-search::placeholder {
  color: var(--text-dim);
}

/* ===== MASTER ACTIONS (Button Row) ===== */
.contacts-actions {
  display: flex;
  gap: 6px;
  padding: 10px 16px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
  flex-wrap: wrap;
}

.contacts-actions button {
  font-size: 12px;
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid var(--border);
  background: var(--bg-element);
  color: var(--text-dim);
  cursor: pointer;
  font-family: inherit;
  white-space: nowrap;
  transition: all 0.2s;
}

.contacts-actions button:hover {
  border-color: var(--accent-cyan);
  color: var(--accent-cyan);
}

.contacts-actions .btn-add {
  background: var(--accent-cyan);
  color: var(--bg-main);
  border-color: var(--accent-cyan);
  font-weight: bold;
  padding: 8px 16px; /* Wider button */
}

.contacts-actions .btn-add:hover {
  opacity: 0.85;
}

/* ===== VIRTUAL SCROLL LIST ===== */
.contacts-list {
  flex: 1;
  overflow-y: auto;
  position: relative;
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

.contacts-list::-webkit-scrollbar {
  width: 6px;
}

.contacts-list::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

/* ===== ALPHABETIC STICKY HEADER ===== */
.contacts-letter-header {
  position: sticky;
  top: 0;
  z-index: 10;
  padding: 6px 16px;
  font-size: 12px;
  font-weight: bold;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--accent-cyan);
  background: var(--bg-card);
  border-bottom: 1px solid var(--border);
}

/* ===== CONTACT LIST ITEM ===== */
.contact-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  cursor: pointer;
  border-bottom: 1px solid rgba(255, 255, 255, 0.04);
  transition: background 0.15s;
}

.contact-item:hover {
  background: rgba(34, 211, 238, 0.06);
}

.contact-item.active {
  background: rgba(34, 211, 238, 0.1);
  border-left: 3px solid var(--accent-cyan);
  padding-left: 13px;
}

.contact-item-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--accent-cyan), var(--accent-violet));
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  font-weight: bold;
  color: white;
  flex-shrink: 0;
  text-transform: uppercase;
}

.contact-item-info {
  flex: 1;
  min-width: 0;
}

.contact-item-name {
  font-size: 14px;
  font-weight: bold;
  color: var(--text-main);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.contact-item-role {
  font-size: 11px;
  color: var(--text-dim);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin-top: 2px;
}

/* ===== COUNT BADGE ===== */
.contacts-count {
  text-align: center;
  padding: 8px 16px;
  font-size: 11px;
  color: var(--text-dim);
  border-top: 1px solid var(--border);
  flex-shrink: 0;
}

/* ===== DETAIL PANEL (Right) ===== */
.contacts-detail {
  flex: 1;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 0 12px 12px 0;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  min-height: 0;
}

@media (max-width: 767px) {
  .contacts-detail {
    position: absolute;
    inset: 0;
    z-index: 100;
    border-radius: 0;
    background: var(--bg-main);
  }
  .contacts-detail.hidden-mobile {
    display: none;
  }
}

/* ===== DETAIL HEADER ===== */
.detail-header {
  display: flex;
  align-items: center;
  gap: 20px;
  padding: 30px;
  border-bottom: 1px solid var(--border);
}

.detail-back-btn {
  display: none;
  background: none;
  border: none;
  color: var(--accent-cyan);
  font-size: 24px;
  cursor: pointer;
  padding: 0;
}

@media (max-width: 767px) {
  .detail-back-btn {
    display: block;
  }
}

.detail-avatar {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--accent-cyan), var(--accent-violet));
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 26px;
  font-weight: bold;
  color: white;
  flex-shrink: 0;
  text-transform: uppercase;
}

.detail-name {
  font-size: 22px;
  font-weight: bold;
  margin: 0;
}

.detail-role {
  font-size: 13px;
  color: var(--accent-cyan);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-top: 4px;
}

/* ===== DETAIL BODY ===== */
.detail-body {
  padding: 24px 30px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  flex: 1;
}

.detail-section {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.detail-section-label {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--text-dim);
  font-weight: bold;
}

.detail-field {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  background: var(--bg-element);
  border-radius: 8px;
  font-size: 14px;
  color: var(--text-main);
  text-decoration: none;
  transition: background 0.15s;
}

a.detail-field:hover {
  background: rgba(34, 211, 238, 0.1);
  color: var(--accent-cyan);
}

.detail-field-icon {
  font-size: 16px;
  flex-shrink: 0;
}

/* ===== DETAIL ACTIONS ===== */
.detail-actions {
  display: flex;
  gap: 10px;
  padding: 20px 30px;
  border-top: 1px solid var(--border);
  flex-shrink: 0;
  flex-wrap: wrap;
}

.detail-actions button {
  padding: 10px 16px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--bg-element);
  color: var(--text-dim);
  cursor: pointer;
  font-family: inherit;
  font-size: 13px;
  transition: all 0.2s;
}

.detail-actions button:hover {
  border-color: var(--accent-cyan);
  color: var(--accent-cyan);
}

.detail-actions .btn-danger {
  border-color: var(--accent-crimson);
  color: var(--accent-crimson);
}

.detail-actions .btn-danger:hover {
  background: rgba(248, 113, 113, 0.1);
}

/* ===== QR CODE CONTAINER ===== */
.detail-qr {
  text-align: center;
  padding: 10px; /* Minskad padding för mindre witt */
  background: white;
  border-radius: 12px;
  margin-top: 10px;
  display: inline-block; /* Behövs men flex-container width överrider */
  transition: background 0.2s;
  align-self: flex-start; /* Prevent stretching full width */
  margin: 10px auto; /* Center optionally? Or keep left? If auto it centers horizontally if flex align is center (but it's stretch). If flex start, margin auto does nothing horizontally unless width set. Let's just align flex-start */
  margin-left: 0; /* Ensures left alignment */
}

/* Dark Mode for QR: Invert colors to make it dark with light pixels */
body.dark-mode .detail-qr {
  background: var(--bg-card);
}

body.dark-mode .detail-qr img {
  filter: invert(1);
  mix-blend-mode: screen;
}

.detail-qr img {
  display: block;
  max-width: 100%;
  height: auto;
  border-radius: 4px;
}

.detail-qr-label {
  color: #333;
  font-size: 12px;
  margin-top: 8px;
  font-weight: bold;
}

body.dark-mode .detail-qr-label {
  color: var(--text-main);
}

/* ===== EMPTY STATE ===== */
.contacts-empty-state {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 16px;
  color: var(--text-dim);
  padding: 40px;
}

.contacts-empty-state .empty-icon {
  font-size: 48px;
  opacity: 0.3;
}

.contacts-empty-state .empty-text {
  font-size: 14px;
  text-align: center;
}

/* ===== CSV IMPORT MODAL ===== */
.csv-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  z-index: 5000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.csv-modal {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  max-width: 600px;
  width: 100%;
  max-height: 80vh;
  overflow-y: auto;
  padding: 24px;
}

.csv-modal h3 {
  margin: 0 0 16px 0;
}

.csv-mapping-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 8px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.csv-mapping-row label {
  width: 120px;
  font-size: 13px;
  color: var(--text-dim);
  flex-shrink: 0;
}

.csv-mapping-row select {
  flex: 1;
  padding: 8px 12px;
  border-radius: 6px;
  border: 1px solid var(--border);
  background: var(--bg-element);
  color: var(--text-main);
  font-family: inherit;
  font-size: 13px;
}

.csv-preview-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
  margin-top: 16px;
}

.csv-preview-table th {
  padding: 6px 8px;
  text-align: left;
  color: var(--accent-cyan);
  border-bottom: 1px solid var(--border);
  font-size: 11px;
  text-transform: uppercase;
}

.csv-preview-table td {
  padding: 6px 8px;
  color: var(--text-dim);
  border-bottom: 1px solid rgba(255, 255, 255, 0.03);
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* ===== TABS (Detail View) ===== */
.detail-tabs {
  display: flex;
  border-bottom: 1px solid var(--border);
  margin-bottom: 20px;
}

.detail-tab-btn {
  flex: 1;
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  padding: 12px;
  cursor: pointer;
  color: var(--text-dim);
  font-weight: bold;
  transition: all 0.2s;
  font-family: inherit;
}

.detail-tab-btn:hover {
  color: var(--text-main);
  background: var(--bg-element);
}

.detail-tab-btn.active {
  color: var(--accent-cyan);
  border-bottom-color: var(--accent-cyan);
}

.tab-content {
  display: none;
  padding: 0 20px 20px 20px;
  animation: fadeIn 0.3s ease;
}

.tab-content.active {
  display: block;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(5px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===== CRM STATUS & TIMELINE ===== */
.crm-status-select {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--bg-element);
  color: var(--text-main);
  margin-bottom: 20px;
  font-weight: bold;
  font-family: inherit;
}

.crm-timeline {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-top: 20px;
  border-left: 2px solid var(--border);
  padding-left: 16px;
}

.crm-timeline-item {
  position: relative;
}

.crm-timeline-item::before {
  content: "";
  position: absolute;
  left: -21px;
  top: 6px;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--accent-cyan);
}

.crm-timeline-date {
  font-size: 11px;
  color: var(--text-dim);
  margin-bottom: 4px;
}

.crm-timeline-content {
  background: var(--bg-element);
  padding: 10px;
  border-radius: 8px;
  font-size: 13px;
  border: 1px solid var(--border);
}

.crm-note-input {
  width: 100%;
  height: 80px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--bg-main);
  color: var(--text-main);
  resize: vertical;
  margin-bottom: 10px;
  font-family: inherit;
}

/* Social Links */
.social-links {
  display: flex;
  gap: 12px;
  margin-bottom: 16px; /* Spacing */
}

.social-btn {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background: var(--bg-element);
  color: var(--text-main);
  text-decoration: none;
  border: 1px solid var(--border);
  font-size: 16px;
  transition: transform 0.2s;
}

.social-btn:hover {
  transform: translateY(-2px);
  border-color: var(--accent-cyan);
  color: var(--accent-cyan);
}

.status-badge {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 6px;
}

/* ===== DESKTOP SIDE-BY-SIDE (Split View) ===== */
@media (min-width: 1024px) {
  .contacts-detail {
    display: grid !important;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr auto; /* Header, Content, Actions */
    gap: 0 30px;
    padding: 30px;
    /* Reset flex props if any */
    flex-direction: unset; 
  }

  /* Header spans full width */
  .detail-header {
    grid-column: 1 / -1;
    margin-bottom: 20px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border);
  }

  /* Hide tab toggle */
  .detail-tabs {
    display: none !important;
  }

  /* Force both contents to show */
  #tab-info, #tab-history {
    display: block !important;
    animation: none;
    padding: 0 !important;
  }

  #tab-info {
    grid-column: 1;
  }

  #tab-history {
    grid-column: 2;
    border-left: 1px solid var(--border);
    padding-left: 30px !important; /* Add divider visual */
  }
  
  /* Timeline spacing adjustment */
  .crm-timeline {
    margin-top: 0; 
  }

  /* Actions at bottom */
  .detail-actions {
    grid-column: 1 / -1;
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
  }
  
  /* Reduce "air" */
  .detail-section {
    margin-bottom: 12px;
  }
  
  .detail-section-label {
    margin-bottom: 4px;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
}
